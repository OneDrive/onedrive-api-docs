---
author: patrick-rodgers & justin-carway
ms.author: patrodg & justincarway
ms.date: 12/07/2023
ms.topic: overview
title: OneDrive File Browser Schema
ms.localizationpriority: High
---

# Browser Configuration Schema

This outlines the full schema available to configure the btowser. These options are passed as shown in the samples.

```TS
{
    sdk: "8.0";
    messaging: {
        /**
         * A unique id assigned by the host app to this File Browser instance.
         * This should ideally be a new GUID generated by the host.
         */
        channelId: string;
        /**
         * The host app's authority, used as the target origin for post-messaging.
         */
        origin: string;
        /**
         * Whether or not the host app window will need to identify itself.
         */
        identifyParent?: boolean;
        /**
         * Whether or not the client app must wait for a 'configure' command to be sent by the host before rendering.
         */
        waitForConfiguration?: boolean;
        /**
         * Whether or not the client app can re-establish a connection to the host after a reload.
         */
        restartable?: boolean;
        /**
         * Override timeout for acknowledgement messages.
         */
        acknowledgeTimeout?: number;
        /**
         * Override timeout for the initialization handshake.
         */
        initializeTimeout?: number;
        /**
         * Override timeout for command responses.
         */
        resultTimeout?: number;
    };
    entry: {
        sharePoint?: {
            /**
             * Specify an exact SharePoint content location by path segments.
             */
            byPath?: {
                /**
                 * Full URL to the root of a Web, or server-relative URL.
                 * @example
                 *  'https://contoso-my.sharepoint.com/personal/user_contoso_com'
                 * @example
                 *  '/path/to/web'
                 * @example
                 *  'subweb'
                 */
                web?: string;
                /**
                 * Full URL or path segement to identity a List.
                 * If not preceded with a `/` or a URL scheme, this is assumed to be a list in the specified web.
                 * @example
                 *  'Shared Documents'
                 * @example
                 *  '/path/to/web/Shared Documents'
                 * @example
                 *  'https://contoso.sharepoint.com/path/to/web/Shared Documents'
                 */
                list?: string;
                /**
                 * Path segment to a folder within a list, or a server-relative URL to a folder.
                 * @example
                 *  'General'
                 * @example
                 *  'foo/bar'
                 * @example
                 *  '/path/to/web/Shared Documents/General'
                 */
                folder?: string;
                /**
                 * Auto fallback to root folder if the specified entry sub folder doesn't exist.
                 */
                fallbackToRoot?: boolean;
            };
        };
        /**
         * Indicates that the File Browser should start in the user's OneDrive.
         */
        oneDrive?: {
            /**
             * Specifies that File Browser should start in the user's Files tab.
             */
            files?: {
                /**
                 * Path segment for sub-folder within the user's OneDrive for business.
                 * @example
                 *  'Pictures'
                 * @example
                 *  '/personal/user_contoso_com/Documents/Attachments'
                 */
                folder?: string;
                /**
                 * Auto fallback to root folder if the specified entry sub folder doesn't exist.
                 */
                fallbackToRoot?: boolean;
            };
            /**
             * Indicates that File Browser should start in the user's recent files.
             */
            recent?: {};
            /**
             * Indicates that File Browser should start in the files shared with the user.
             */
            sharedWithMe?: {};
            /**
             * Indicates that File Browser should start in the user's lists.
             */
            myLists?: {};
            /**
             * Indicates that File Browser should start in the user's recent lists.
             */
            recentLists?: {};
        };
        /**
         * If the entry location is to be loaded via a shortcut lens, where was the shortcut from?
         */
        shortcut?: {
            sharePoint?: {
                byPath?: {
                    web?: string;
                    list?: string;
                    folder?: string;
                };
            };
            teamChannel?: {
                web?: string;
                list?: string;
                groupId?: string;
                channelId?: string;
                displayName?: string;
            };
            graph?: {
                byId?: {
                    driveId?: string;
                    itemId?: string;
                };
            };
        };
        /**
         * If the entry location is to be rendered in a OneUp configuration, what item should be 'focused'?
         * The specified item will be rendered in context of the main item's children.
         */
        focus?: {
            sharePoint?: {
                byPath?: {
                    web?: string;
                    list?: string;
                    folder?: string;
                };
            };

            graph?: {
                byId?: {
                    driveId?: string;
                    itemId?: string;
                };
            };
        };
        sortBy?: {
            /**
             * Name of the field *in SharePoint* on which to sort.
             */
            fieldName: string;
            /**
             * Whether or not to sort in ascending order. Default is `true`.
             */
            isAscending?: boolean;
        };
        filterBy?: {
            /**
             * Name of the field *in SharePoint* on which to filter on.
             */
            fieldName: string;
            /**
             * Filter value
             */
            value: string;
        };
    };
    /**
     * Configuration for handling authentication requests from the embedded app.
     * Presence of this object (even if empty) indicates that the host will handle authentication.
     * Omitting this will make the embedded content attempt to rely on cookies.
     */
    authentication?: {
        /**
         * @default true
         */
        enabled?: boolean;
        /**
         * Indicates that the host app can handle 'claims' challenges.
         */
        claimsChallenge?: {
            /**
             * @default false
             */
            enabled?: boolean;
        };
    };
    breadcrumb?: {
        /**
         * Specify the root crumb folder path
         */
        root?: {
            sharePoint?: {
                byPath?: {
                    web?: string;
                    list?: string;
                    folder?: string;
                };
            };
        };
    };
    /**
     * Configures how commands behave within the experience.
     */
    commands?: {
        /**
         * Overrides the "open" behavior for files and folders.
         */
        open?: {
            /**
             * Specifies a series of 'handlers' for clicking files and folders.
             * For each handler, the invoked item is tested against `filters`,
             * and the first matching handler has its behavior applied.
             * If no handler matches, the default behavior applies.
             */
            handlers?: {
                filters?: `.${string}`[];
                /**
                 * Specifies the target for opening the item
                 * - `none`: Do not allow the item to be opened.
                 * - `navigate`: Open the item within the experience.
                 * - `external`: Open the item in a new tab.
                 * - `host`: Ask the host to open the item.
                 */
                target?: 'none' | 'navigate' | 'external' | 'host';
            }[];
        };
        /**
         * Overrides behaviors for the view-switch dropdown.
         */
        switchView?: {
            enabled?: boolean;
            views: {
                /**
                 * @default false
                 */
                smartTemplate?: boolean;
            };
        };
        /**
         * Overrides behaviors for editing SharePoint views.
         */
        editView?: {
            enabled?: boolean;
        };
        /**
         * Overrides behaviors for creating SharePoint views.
         */
        createView?: {
            enabled?: boolean;
        };
        /**
         * Specifies the behavior for closing the experience.
         */
        close?: {
            /**
             * A custom label to apply to the 'cancel' button.
             * This must be localized by the host app if supplied.
             */
            label?: string;
        };
        /**
         * Behavior for a "Switch account" command.
         */
        switchAccount?: {
            mode?: 'host' | 'none';
        };
        /**
         * Behavior for a "Manage accounts" command.
         */
        manageAccounts?: {
            mode?: 'host' | 'none';
            label?: string;
        };
        /**
         * Behavior for "Upload"
         */
        upload?: {
            enabled?: boolean;
        };
        /**
         * Behavior for "Create folder"
         */
        createFolder?: {
            enabled?: boolean;
        };
        /**
         * Behavior for "Filter by" in the column headers.
         */
        filterByColumn?: {
            mode?: 'panel' | 'menu';
        };
        /**
         * Configuration for a command to open the current item in the full SharePoint site.
         */
        openInSharePoint?: {
            enabled?: boolean;
            location?: 'header' | 'command-bar';
        };
        /**
         * How to handle "Open in Desktop" protocol callbacks
         */
        openInDesktop?: {
            /**
             * @default 'inline'
             */
            mode: 'external' | 'inline' | 'host' | 'none';
        };
        /**
         * How to handle actions defined by custom formatters.
         */
        customFormatter?: {
            actions?: {
                key: string;
                mode?: 'host' | 'none';
            }[];
        };
        /**
         * How to handle specified values for `key` in custom commands
         * in the tray, nav, or command bar.
         */
        custom?: {
            actions?: {
                key: string;
                /**
                 * Filters defining what types of items the action operates on.
                 * If specified, the action will only be available for items which match the given filters.
                 */
                filters?: `.${string}`[];
                /**
                 * How the action is invoked.
                 * 'host': Invokes a `custom` command message against the host app.
                 * 'none': Disables the action.
                 */
                mode?: 'host' | 'none';
                /**
                 * Selection criteria to which the item applies.
                 */
                selection?: 'single' | 'multiple' | 'current' | 'none';
            }[];
        };
    };
    /**
     * Configures what types of items are allowed to be browsered and selected within the experience.
     * Note that the default configuration accounts for the expected authentication capabilities of the host app.
     * Depending on what else is enabled by the host, the host may be expected to provide tokens for more services and scopes.
     */
    typesAndSources?: {
        /**
         * Configures the base type of item which will be displayed.
         * Only items of this general type will be selectable.
         */
        mode?: 'files' | 'folders' | 'all';
        /**
         * `filters` options: file extension, i.e. .xlsx, .docx, .ppt, etc.
         * `filters` options: 'photo', 'folder', 'video', 'documentLibrary'
         */
        filters?: `.${string}`[];
        /**
         * Specifies a filter for *where* the item may come from.
         */
        locations?: {
            /**
             * Items may only come from the user's OneDrive.
             */
            oneDrive?: {};
            /**
             * Items may only come from a specific location within SharePoint.
             */
            sharePoint?: {
                byPath?: {
                    web?: string;
                    list?: string;
                    folder?: string;
                };
            };
        };
        /**
         * Specifies which pivots the user may access while browsing files and lists.
         * Note that if a pivot is disabled here but still targeted in `entry`, it will still be visible in the nav.
         */
        pivots?: {
            /**
             * Show "My files".
             */
            oneDrive?: boolean;
            /**
             * Show "Recent".
             */
            recent?: boolean;
            /**
             * Show "Shared"
             */
            shared?: boolean;
            /**
             * Show "Cloud storage". The host app must be Teams.
             */
            teamsCloudStorage?: boolean;
            /**
             * Show "Quick access".
             */
            sharedLibraries?: boolean;
            /**
             * Show "My lists".
             */
            myLists?: boolean;
            /**
             * Show "Recent lists".
             */
            recentLists?: boolean;
        };
    };
    accessibility?: {
        /**
         * Whether or not to 'trap focus' within the component. If this is enabled, tab-stops will loop from the last element back to the left navigation automatically. 
         * This is useful if the components's frame is hosted as the only content of a modal overlay and focus should not jump to the outside content.
         *
         * @default false
         */
        enableFocusTrap?: boolean;
        /**
         * Whether or not the component should immediately grab focus once the content has loaded.
         *
         * @default true
         */
        trapFocusOnLoad?: boolean;
        /**
         * Whether or not to force the currently-focused element within the component to be highlighted.
         * By default, the focused element is highlighted if the user navigates elements with the keyboard but not when the user interacts via the mouse.
         * However, if a host application launches the component due to keyboard input it should set this flag to `true` to ensure continuity of behavior.
         *
         * @default false
         */
        showFocusOnLoad?: boolean;
    };
    theme?: | 'default' | 'dark' | 'lists' | 'teams' | 'teams-default' | 'teams-dark' | 'teams-contrast';
    navigation?: {
        /**
         * How navigation within the File Browser should work.
         * - @default 'notify': File Browser handles navigation internally, notifies host of changes.
         * - 'host': File Browser sends navigation request to host, does not immediately navigate.
         */
        mode?: 'host' | 'notify';
    };
    /**
     * Configuration for what item types may be selected within the browser and returned to the host.
     */
    selection?: {
        /**
         * Controls how selection works within the list.
         * @default 'multiple' for the Browser.
         */
        mode?: 'single' | 'multiple' | 'pick';
        /**
         * Whether or not to allow the user to maintain a selection across folders and pivots.
         */
        enablePersistence?: boolean;
        /**
         * Whether or not the host expectes to be notified whenever selection changes.
         */
        enableNotifications?: boolean;
        /**
         * The maximum number of items which may selected.
         */
        maximumCount?: number;
    };
    leftNav?: {
        /**
         * Whether or not a Left Nav should be rendered by the embedded content.
         */
        enabled?: boolean;
        /**
         * Mode of presentation of the nav.
         * If the nav is enabled but this is set to `host`, the embedded app
         * will show a button to ask the host app to show a nav.
         */
        mode?: 'host' | 'default';
        /**
         * Indicates whether the left nav will be initially modal.
         */
        initialModality?: 'modal' | 'hidden';

        /**
         * Type of left nav
         */
        preset?: 'oneDrive' | 'current-site';

        /**
         * Custom commands to insert at the end of the left nav. Will appear before the default set.
         */
        commands?: {
            /**
             * Name to use when notifying the host that the command is being invoked.
             */
            key: string;
            /**
             * Localized string to use for the button text.
             */
            label: string;
            /**
             * Type of action which will be performed when the command is clicked.
             * 'custom': Configured via `commands.custom`.
             */
            action: 'custom' | 'pick' | 'close' | 'browse-this-device';
            /**
             * Name of a Fluent icon to use for the command button.
             */
            icon?: string;
        }[];
    };
    list?: {
        /**
         * A custom override for the initial list layout.
         */
        layout?: {
            /**
             * Sets the preferred starting layout for the initial content.
             */
            type?: 'details' | 'compact-details' | 'tiles';
        };
        /**
         * Configures scrolling behavior within the Browser.
         */
        scrolling?: {
            enableStickyHeaders?: boolean;
        };
    };
}
```