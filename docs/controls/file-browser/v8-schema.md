# Browser Configuration Schema

This outlines the full schema available to configure the btowser. These options are passed as shown in the samples.

```TS
{
    sdk: "8.0";
    messaging: {
        /**
         * A unique id assigned by the host app to this File Browser instance.
         * This should ideally be a new GUID generated by the host.
         */
        channelId: string;
        /**
         * The host app's authority, used as the target origin for post-messaging.
         */
        origin: string;
    };
    entry: {
        sharePoint?: {
            /**
             * Specify an exact SharePoint content location by path segments.
             */
            byPath?: {
                /**
                 * Full URL to the root of a Web, or server-relative URL.
                 * @example
                 *  'https://contoso-my.sharepoint.com/personal/user_contoso_com'
                 * @example
                 *  '/path/to/web'
                 * @example
                 *  'subweb'
                 */
                web?: string;
                /**
                 * Full URL or path segement to identity a List.
                 * If not preceded with a `/` or a URL scheme, this is assumed to be a list in the specified web.
                 * @example
                 *  'Shared Documents'
                 * @example
                 *  '/path/to/web/Shared Documents'
                 * @example
                 *  'https://contoso.sharepoint.com/path/to/web/Shared Documents'
                 */
                list?: string;
                /**
                 * Path segment to a folder within a list, or a server-relative URL to a folder.
                 * @example
                 *  'General'
                 * @example
                 *  'foo/bar'
                 * @example
                 *  '/path/to/web/Shared Documents/General'
                 */
                folder?: string;
                /**
                 * Auto fallback to root folder if the specified entry sub folder doesn't exist.
                 */
                fallbackToRoot?: boolean;
            };
        };
        /**
         * Indicates that the File Browser should start in the user's OneDrive.
         */
        oneDrive?: {
            /**
             * Specifies that File Browser should start in the user's Files tab.
             */
            files?: {
                /**
                 * Path segment for sub-folder within the user's OneDrive.
                 * @example
                 *  'Pictures'
                 * @example
                 *  '/personal/user_contoso_com/Documents/Attachments'
                 */
                folder?: string;
                /**
                 * Auto fallback to root folder if the specified entry sub folder doesn't exist.
                 */
                fallbackToRoot?: boolean;
            };
        };
        /**
         * Providing this object indicates that the host app can provide OAuth tokens
         * via the existing messaging support.
         * Indicate that passing at least authentication: {} is required in order for the File 
         * Browser to be able to authenticate and load in an iframe.
         */
        authentication: {
            claimsChallenge?: {
                enabled?: boolean;
            };
        };
        breadcrumb?: {
            /**
             * Specify the root crumb folder path
             */
            root?: {
                sharePoint?: {
                    byPath?: {
                        web?: string;
                        list?: string;
                        folder?: string;
                    };
                };
            };
        };
        commands?: {
            /**
             * Overrides the "open" behavior for files and folders.
             */
            open?: {
                /**
                 * Specifies a series of 'handlers' for clicking files and folders.
                 * For each handler, the invoked item is tested against `filters`,
                 * and the first matching handler has its behavior applied.
                 * If no handler matches, the default behavior applies.
                 */
                handlers?: {
                    filters?: `.${string}`[];
                    /**
                     * Specifies the target for opening the item
                     * - `none`: Do not allow the item to be opened.
                     * - `navigate`: Open the item within the experience.
                     * - `external`: Open the item in a new tab.
                     * - `host`: Ask the host to open the item.
                     */
                    target?: 'none' | 'navigate' | 'external' | 'host';
                }[];
            };
            /**
             * Overrides behaviors for the view-switch dropdown.
             */
            switchView?: {
                enabled?: boolean;
                views: {
                    smartTemplate?: boolean; // default false
                };
            };
            /**
             * Overrides behaviors for editing SharePoint views.
             */
            editView?: {
                enabled?: boolean;
            };
            /**
             * Overrides behaviors for creating SharePoint views.
             */
            createView?: {
                enabled?: boolean;
            };
            /**
             * Specifies the behavior for closing the experience.
             */
            close?: {
                /**
                 * A custom label to apply to the 'cancel' button.
                 * This must be localized by the host app if supplied.
                 */
                label?: string;
            };
            /**
             * Behavior for "Upload"
             */
            upload?: {
                enabled?: boolean;
            };
            /**
             * Behavior for "Create folder"
             */
            createFolder?: {
                enabled?: boolean;
            };
            /**
             * Behavior for "Filter by" in the column headers.
             */
            filterByColumn?: {
                mode?: 'panel' | 'menu';
            };
            /**
             * Configuration for a command to open the current item in the full SharePoint site.
             */
            openInSharePoint?: {
                enabled?: boolean;
                location?: 'header' | 'command-bar';
            };
            /**
             * How to handle "Open in Desktop" protocol callbacks
             */
            openInDesktop?: {
                /**
                 * @default 'inline'
                 */
                mode: 'external' | 'inline' | 'host' | 'none';
            };
            /**
             * How to handle specified values for `key` in custom commands
             * in the tray, nav, or command bar.
             */
            custom?: {
                actions?: {
                    key: string;
                    /**
                     * Filters defining what types of items the action operates on.
                     * If specified, the action will only be available for items which match the given filters.
                     */
                    filters?: `.${string}`[];
                    /**
                     * How the action is invoked.
                     * 'host': Invokes a `custom` command message against the host app.
                     * 'none': Disables the action.
                     */
                    mode?: 'host' | 'none';
                    /**
                     * Selection criteria to which the item applies.
                     */
                    selection?: 'single' | 'multiple' | 'current' | 'none';
                }[];
            };
        };
        /**
         * Specifies what types of items may be picked and where they come from.
         */
        typesAndSources?: {
            /**
             * `filters` options: file extension, i.e. .xlsx, .docx, .ppt, etc.
             * `filters` options: 'photo', 'folder', 'video', 'documentLibrary'
             */
            filters?: `.${string}`[];
        };
        accessibility?: {
            /**
             * Whether or not to 'trap focus' within the component. If this is enabled, tab-stops will loop from
             * the last element back to the left navigation automatically. This is useful if the components's frame
             * is hosted as the only content of a modal overlay and focus should not jump to the outside content.
             *
             * @default `false`
             */
            enableFocusTrap?: boolean;
            /**
             * Whether or not the component should immediately grab focus once the content has loaded.
             *
             * @default `true`
             */
            trapFocusOnLoad?: boolean;
            /**
             * Whether or not to force the currently-focused element within the component to be highlighted.
             * By default, the focused element is highlighted if the user navigates elements with the keyboard
             * but not when the user interacts via the mouse. However, if a host application launches the component
             * due to keyboard input is should set this flag to `true` to ensure continuity of behavior.
             *
             * @default `false`
             */
            showFocusOnLoad?: boolean;
        };
        /**
         * Specified how many items may be picked.
         */
        selection?: {
            /**
             * Whether or not the host expectes to be notified whenever selection changes.
             */
            enableNotifications?: boolean;
        };
        list?: {
            /**
             * A custom override for the initial list layout.
             */
            layout?: {
                /**
                 * Sets the preferred starting layout for the initial content.
                 */
                type?: 'details' | 'compact-details' | 'tiles';
            };
        };
    }
}
```