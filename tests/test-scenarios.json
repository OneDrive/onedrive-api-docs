{
  "canned-requests": [
    {
      "name": "create-photo-item",
      "method": "upload-via-put",
      "request-parameters": {
        "!url": "/me/drive/root:{item-path}:/content",
        "{item-path}": "!random-filename-png",
        "!body.base64": "iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
      },
      "capture": {
        "[item-id]": "$.id"
      },
      "implicit-variable": "{photo-item-id}"
    },
    {
      "name": "create-file-item",
      "method": "upload-via-put",
      "request-parameters": {
        "!url": "/me/drive/root:{item-path}:/content",
        "{item-path}": "!random-filename-txt",
        "!body": "This is a test file generated by markdown-scanner. See https://github.com/onedrive/markdown-scanner for more details.",
        "Content-Type:": "application/octet-stream"
      },
      "capture": {
        "[item-id]": "$.id"
      },
      "implicit-variable": "{file-item-id}"
    },

    {
      "name": "create-folder-item",
      "method": "create-folder",
      "request-parameters": {
        "$.name": "!random-filename!"
      },
      "capture": {
        "[item-id]": "$.id"
      },
      "implicit-variable": "{folder-item-id}"
    },

    {
      "name": "get-sites-root",
      "method": "get-site",
      "request-parameters": {
        "{site-id}": "root"
      },
      "capture": {
        "[site-id]": "$.id"
      }
    }
  ],
  "scenarios": [
    {
      "name": "Get default drive",
      "method": "get-drive-default",
      "enabled": true
    },

    {
      "method": "template-method-name",
      "enabled": false,
      "name": "Template method test"
    },

    {
      "name": "Get drive by drive ID",
      "method": "get-drive-by-id",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "{drive-id}": "[read-drive-id]"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "capture": {
            "[read-drive-id]": "$.id"
          }
        }
      ],
      "expectations": {
        "$.driveType": [ "personal", "business", "documentLibrary" ]
      }
    },

    {
      "name": "Check in item",
      "method": "checkin-item",
      "enabled": true,

      "request-parameters": {
        "{drive-id}": "[drive-id]",
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "capture": {
            "[drive-id]": "$.id"
          }
        },
        {
          "canned-request": "create-file-item"
        },
        {
          "method": "checkout-item",
          "request-parameters": {
            "{drive-id}": "[drive-id]",
            "{item-id}": "[item-id]",
            "!body": ""
          }
        }
      ]
    },

    {
      "name": "Checkout item",
      "method": "checkout-item",
      "enabled": true,

      "request-parameters": {
        "{drive-id}": "[read-drive-id]",
        "{item-id}": "[item-id]",
        "Content-Type": "text/plain",
        "!body": "hello"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "capture": {
            "[read-drive-id]": "$.id"
          }
        },
        {
          "canned-request": "create-file-item"
        }
      ]
    },

    {
      "name": "Copy file to new filename",
      "method": "copy-item",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "$.parentReference.driveId": "[drive-id]",
        "$.parentReference.id": null,
        "$.parentReference.path": "/drive/root:/Documents",
        "$.name": "foobar.txt"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "{item-id}": "root:/Documents/foobar.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "canned-request": "create-file-item"
        },
        {
          "method": "get-drive-default",
          "capture": {
            "[drive-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Copy file and replace",
      "method": "copy-item",
      "enabled": true,
      "tags": [ "service.onedrive" ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "$.parentReference.driveId": "[drive-id]",
        "$.parentReference.id": null,
        "$.parentReference.path": "/drive/root:/Documents",
        "$.name": "foobar.txt",
        "$.['@microsoft.graph.conflictBehavior']": "replace"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "{item-id}": "root:/Documents/foobar.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        { "canned-request": "create-file-item" },
        {
          "method": "get-drive-default",
          "capture": {
            "[drive-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Create embedded link",
      "method": "create-embedded-link",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        { "canned-request": "create-file-item" }
      ]
    },

    {
      "name": "Get first medium thumbnail",
      "method": "get-one-thumbnail",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{thumb-id}": "0",
        "{size}": "medium"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ],
      "status-codes-to-retry": [ 404 ]
    },

    {
      "name": "Get thumbnails while expanding",
      "method": "get-thumbnail-while-listing",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "root"
      }
    },

    {
      "name": "Enumerate thumbnails for photo folder",
      "method": "enum-item-thumbnails",
      "tags": [ "service.onedrive" ],
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[folder-item-id]"
      },
      "test-setup": [
        {
          "method": "get-special-folder",
          "request-parameters": {
            "{special-folder-name}": "photos"
          },
          "capture": {
            "[folder-item-id]": "$.id"
          }
        },
        {
          "canned-request": "create-photo-item",
          "request-parameters": {
            "!url": "/drive/special/photos:{item-path}:/content"
          }
        }
      ]
    },

    {
      "name": "Enumerate thumbnails for a photo",
      "method": "enum-item-thumbnails",
      "enabled": false,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ]
    },

    {
      "name": "Download large item thumbnail",
      "method": "get-thumbnail-content",
      "enabled": true,
      "status-codes-to-retry": [ 404 ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{thumb-id}": "0",
        "{size}": "large"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ]
    },

    {
      "name": "Find items with 2014 in the keywords",
      "method": "search-at-root",
      "enabled": true,

      "request-parameters": {
        "{search-text}": "2014"
      }
    },

    {
      "name": "Perform item search",
      "method": "item_search",
      "enabled": true,

      "request-parameters": {
        "{search-query}": "documents"
      }
    },

    {
      "name": "Add custom thumbnail to non-image file",
      "method": "add-custom-thumbnail",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "!body.base64": "iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
      },
      "test-setup": [
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:{item-path}:/content",
            "{item-path}": "!random-filename-txt",
            "!body": "Test file where we can add a custom thumbnail."
          },
          "capture": {
            "[item-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Get custom thumbnail size",
      "method": "get-thumbnail-custom-size",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ]
    },

    {
      "name": "Get root folder changes",
      "method": "get-changes",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "root",
        "{token}": "a"
      }
    },

    {
      "name": "Get latest sync token for root",
      "method": "get-changes-latest",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "root"
      }
    },

    {
      "name": "Delete a Folder",
      "method": "delete-item",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-folder-item" } ]
    },

    {
      "name": "Delete an item from a site list",
      "method": "delete-item-site",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-folder-item" } ]
    },

    {
      "name": "Get a list of available thumbnails",
      "method": "expand-thumbnails",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ]
    },

    {
      "name": "Select custom source thumbnail",
      "method": "get-custom-thumbnail",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [ { "canned-request": "create-photo-item" } ]
    },

    {
      "name": "Upload new file to folder named pictures",
      "method": "upload-via-put",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "!url": "/me/drive/root:{item-path}:/content",
        "{item-path}": "/pictures/newfile.txt"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "{item-id}": "root:/pictures/newfile.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        }
      ]
    },

    {
      "name": "Download a text file",
      "method": "download-item-content",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": { "{item-id}": "[item-id]" },
      "test-setup": [ { "canned-request": "create-file-item" } ]
    },

    {
      "name": "Documents folder",
      "method": "get-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "documents"
      }
    },

    {
      "name": "Photos folder",
      "method": "get-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "photos"
      }
    },

    {
      "name": "Camera Imports",
      "method": "get-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "cameraImports"
      }
    },

    {
      "name": "Camera Roll folder",
      "method": "get-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "cameraroll"
      },
      "test-setup": [
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/special/cameraroll:{filename}:/content",
            "{filename}": "!random-filename-png",
            "Content-Type:": null,
            "!body.base64": "iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
          },
          "capture": {
            "[new-item-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Application folder",
      "method": "get-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "approot"
      }
    },

    {
      "name": "Documents folder",
      "method": "get-special-children",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "documents"
      }
    },

    {
      "name": "Photos folder",
      "method": "get-special-children",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "photos"
      }
    },

    {
      "name": "Camera Roll folder",
      "method": "get-special-children",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "cameraroll"
      }
    },

    {
      "name": "Public folder",
      "method": "get-special-children",
      "enabled": true,
      "tags": [ "service.onedrive" ],

      "request-parameters": {
        "{special-folder-name}": "public"
      }
    },

    {
      "name": "Application folder",
      "method": "get-special-children",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "approot"
      },
      "test-setup": [
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/special/approot:{filename}:/content",
            "{filename}": "!random-filename-png",
            "!body.base64": "iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="
          }
        }
      ]
    },

    {
      "name": "Set up for testing that HEAD doesn't auto-provision special folders",
      "method": "head-does-not-create-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "approot"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/special/approot"
          },
          "allowed-status-codes": [ 204, 404 ]
        }
      ]
    },

    {
      "name": "Set up to test that HEAD works on existing special folders",
      "method": "head-existing-special-folder",
      "enabled": true,

      "request-parameters": {
        "{special-folder-name}": "approot"
      },
      "test-setup": [
        {
          "method": "get-special-folder",
          "request-parameters": {
            "{special-folder-name}": "approot"
          }
        }
      ]
    },

    {
      "name": "Create ApiTestTool folder",
      "method": "create-folder",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "$.name": "ApiTestTool"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/ApiTestTool" },
          "allowed-status-codes": [ 204, 404 ]
        }
      ]
    },

    {
      "name": "Move file to documents folder",
      "method": "move-item",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[new-item-id]",
        "$.parentReference.id": null,
        "$.parentReference.path": "/drive/root:/Documents"
      },

      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/Documents/hello.txt" },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/Documents/new-item-name.txt" },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/me/drive/root:{item-path}:/content",
            "{item-path}": "/hello.txt"
          },
          "capture": {
            "[new-item-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Move folder from root to Documents folder",
      "method": "update-item",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "$.name": "newFolderName",
        "$.parentReference.path": "/drive/root:/Documents"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/documents/newFolderName" },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": { "$.name": "newFolderName" },
          "capture": { "[item-id]": "$.id" }
        }
      ]
    },

    {
      "name": "Multipart upload into a children collection",
      "method": "upload-multipart",
      "enabled": false,

      "request-parameters": {
        "!url": "/me/drive/items/{folder-id}/children",
        "{folder-id}": "[new-folder-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/multipart_upload_test" },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": { "$.name": "multipart_upload_test" },
          "capture": { "[new-folder-id]": "$.id" }
        }
      ]
    },

    {
      "name": "Upload a file from URL",
      "method": "upload-from-url",
      "enabled": true,

      "request-parameters": {
        "{parent-item}": "root:/pictures:"
      }
    },

    {
      "name": "Create a sharing link for an item",
      "method": "create-link",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "{item-id}": "[new-item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": { "{item-id}": "root:/Documents/sharedfile.txt" },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/me/drive/root:{item-path}:/content",
            "{item-path}": "/Documents/sharedfile.txt",
            "!body": "Test file that we will share"
          },
          "capture": { "[new-item-id]": "$.id" }
        }
      ]
    },

    {
      "name": "Search all items",
      "method": "item_search_all",
      "enabled": true,

      "request-parameters": {
        "{search-query}": "documents"
      }
    },

    {
      "name": "Get site",
      "method": "get-site",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" }
      ]
    },

    {
      "name": "Get site by hostname and path",
      "method": "get-site-by-hostname-and-path",
      "enabled": true,

      "request-parameters": {
        "{hostname}": "seattleappworks.sharepoint.com",
        "{relative-path}": "[relative-path]"
      },
      "test-setup": [
        {
          "method": "list-subsites",
          "request-parameters": {
            "{site-id}": "seattleappworks.sharepoint.com"
          },
          "capture": {
            "[relative-path]": "$.value[0].name"
          }
        }
      ]
    },

    {
      "name": "Search",
      "method": "search-sites",
      "enabled": true,

      "request-parameters": {
        "{query}": "seattleappworks"
      }
    },

    {
      "name": "List group drives",
      "method": "group-list-drives",
      "enabled": false,

      "request-parameters": {
        "{groupId}": "[groupId]"
      },
      "test-setup": [
        {
          "http-request": "GET /groups",
          "allowed-status-codes": [ 200 ],
          "capture": {
            "[groupId]": "$.id"
          }
        }
      ]
    },

    {
      "name": "List site drives",
      "method": "site-list-drives",
      "enabled": true,

      "request-parameters": {
        "{siteId}": "[site-id]"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" }
      ]
    },

    {
      "name": "List user drives",
      "method": "user-list-drives",
      "enabled": true,

      "request-parameters": {
        "{userId}": "[userId]"
      },
      "test-setup": [
        {
          "http-request": "GET /drive",
          "allowed-status-codes": [ 200 ],
          "capture": {
            "[userId]": "$.owner.user.id"
          }
        }
      ]
    },

    {
      "name": "List subsites",
      "method": "list-subsites",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" }
      ]
    },

    {
      "name": "Get list",
      "method": "get-list",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]",
        "{list-id}": "[list-id]"
      },
      "test-setup": [
        {
          "canned-request": "get-sites-root"
        },
        {
          "method": "enum-lists",
          "request-parameters": {
            "{site-id}": "[site-id]"
          },
          "capture": {
            "[list-id]": "$.value[2].id"
          }
        }
      ]
    },

    {
      "name": "Get list",
      "method": "get-list-multi-expand",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]",
        "{list-id}": "[list-id]"
      },
      "test-setup": [
        {
          "canned-request": "get-sites-root"
        },
        {
          "method": "enum-lists",
          "request-parameters": {
            "{site-id}": "[site-id]"
          },
          "capture": {
            "[list-id]": "$.value[2].id"
          }
        }
      ]
    },

    {
      "name": "Get list item, expand fields",
      "method": "get-list-item",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]",
        "{list-id}": "[list-id]",
        "{item-id}": "1"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" },
        {
          "method": "enum-lists",
          "request-parameters": {
            "{site-id}": "[site-id]"
          },
          "capture": {
            "[list-id]": "$.value[2].id"
          }
        }
      ]
    },

    {
      "name": "Get list items",
      "method": "get-list-items",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]",
        "{list-id}": "[list-id]"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" },
        {
          "method": "enum-lists",
          "request-parameters": {
            "{site-id}": "[site-id]"
          },
          "capture": {
            "[list-id]": "$.value[2].id"
          }
        }
      ]
    },

    {
      "name": "Create a list item",
      "method": "create-listitem",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "seattleappworks.sharepoint.com,70a23224-bf15-4b5e-b6f8-a20eefdf881a,17b3eab0-65b5-4f06-8672-e146e18e6b6b",
        "{list-id}": "[list-id]",
        "$.fields.Color": null,
        "$.fields.Weight": null
      },
      "test-setup": [
        { "canned-request": "get-sites-root" },
        {
          "method": "enum-lists",
          "request-parameters": {
            "{site-id}": "[site-id]"
          },
          "capture": {
            "[list-id]": "$.value[2].id"
          }
        }
      ]
    },

    {
      "name": "Update a list item",
      "method": "update-listitem",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "seattleappworks.sharepoint.com,70a23224-bf15-4b5e-b6f8-a20eefdf881a,17b3eab0-65b5-4f06-8672-e146e18e6b6b",
        "{list-id}": "[list-id]",
        "{item-id}": "[item-id]",
        "$.Color": null,
        "$.Quantity": null,
        "$.Weight": null
      },
      "test-setup": [
        {
          "http-request": "GET /sites/seattleappworks.sharepoint.com,70a23224-bf15-4b5e-b6f8-a20eefdf881a,17b3eab0-65b5-4f06-8672-e146e18e6b6b/lists",
          "allowed-status-codes": [ 200 ],
          "capture": {
            "[list-id]": "$.value[0].id"
          }
        },
        {
          "method": "get-list-items",
          "request-parameters": {
            "{site-id}": "seattleappworks.sharepoint.com,70a23224-bf15-4b5e-b6f8-a20eefdf881a,17b3eab0-65b5-4f06-8672-e146e18e6b6b",
            "{list-id}": "[list-id]"
          },
          "capture": {
            "[item-id]": "$.value[0].id"
          }
        }
      ]
    },

    {
      "name": "Create a list",
      "method": "create-list",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "seattleappworks.sharepoint.com,70a23224-bf15-4b5e-b6f8-a20eefdf881a,17b3eab0-65b5-4f06-8672-e146e18e6b6b",
        "$.displayName": "Books",
        "$.name": null
      }
    },

    {
      "name": "Enumerate a list",
      "method": "enum-lists",
      "enabled": true,

      "request-parameters": {
        "{site-id}": "[site-id]"
      },
      "test-setup": [
        { "canned-request": "get-sites-root" }
      ]
    },

    {
      "name": "Get list of items shared with me",
      "method": "shared-with-me",
      "enabled": true
    },

    {
      "name": "Get a permission from an item.",
      "method": "get-item-permission",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{perm-id}": "[perm-id]"
      },
      "test-setup": [
        { "canned-request": "create-file-item" },
        {
          "method": "create-link",
          "request-parameters": {
            "{item-id}": "[item-id]"
          },
          "capture": {
            "[perm-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "List activities",
      "method": "list-activities",
      "enabled": true,

      "request-parameters": {
        "{drive-id}": "[drive-id]",
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "request-parameters": {
            "!url": "/drive"
          },
          "capture": {
            "[drive-id]": "$.id"
          }
        },
        {
          "method": "get-drive-by-id",
          "request-parameters": {
            "{drive-id}": ""
          },
          "capture": {
            "[drive-id]": "$.value[0].id"
          }
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/testing.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:{item-path}:/content",
            "{item-path}": "/testing.txt",
            "Content-Type:": "application/octet-stream",
            "!body": "Test file for list activities."
          },
          "capture": {
            "[item-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "List children from path",
      "method": "list-children",
      "enabled": true,

      "request-parameters": {
        "{drive-id}": "[drive-id]",
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "get-drive-by-id",
          "request-parameters": {
            "{drive-id}": ""
          },
          "allowed-status-codes": [ 200 ],
          "capture": {
            "[drive-id]": "$.value[0].id"
          }
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/Test/FolderWithChildren"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:{item-path}",
            "{item-path}": "/Test/FolderWithChildren",
            "Content-Type:": "application/json",
            "!body": "{\"folder\":{}}"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:{item-path}:/content",
            "{item-path}": "/Test/FolderWithChildren/testfile.txt",
            "Content-Type:": "application/octet-stream",
            "!body": "Test file for expand option"
          }
        }
      ]
    },

    {
      "name": "List children from path",
      "method": "list-children-from-path",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "{drive-id}": "[drive-id]",
        "{path-relative-to-root}": "documents"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "capture": {
            "[drive-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Filter by image",
      "method": "filtering-image-file",
      "enabled": true,

      "test-setup": [
        {
          "http-request": "DELETE /drive/root:/vacation.png",
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "http-request": "PUT /drive/root:/vacation.png:/content\r\nContent-Type: application/json\r\n\r\n{\"file\":{},\"@content.sourceUrl\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"}"
        }
      ]
    },

    {
      "name": "Enumerate an item's permissions",
      "method": "get-item-permissions",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]"
      },

      "test-setup": [
        { "canned-request": "create-file-item" },
        {
          "method": "create-link",
          "request-parameters": {
            "{item-id}": "[item-id]"
          },
          "capture": {
            "[perm-id]": "$.id"
          }
        }
      ],
      "expectations": {
        "$.value[0].link.type": "view",
        "$.value[0].roles[0]": "read"
      }
    },

    {
      "name": "Delete an item's permissions",
      "method": "delete-permission",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{perm-id}": "[perm-id]"
      },

      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "{item-id}": "root:/Documents/sharedfile.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/me/drive/root:{item-path}:/content",
            "{item-path}": "/Documents/sharedfile.txt",
            "Content-Type": "application/octet-stream",
            "!body": "Test file that we will share"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "create-link",
          "request-parameters": { "{item-id}": "root:/Documents/sharedfile.txt:" },
          "capture": { "[perm-id]": "$.id" }
        }
      ]
    },

    {
      "name": "Get single permission on item",
      "method": "get-single-permission",
      "enabled": true,

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{permission-id}": "[perm-id]"
      },

      "test-setup": [
        { "canned-request": "create-file-item" },
        {
          "method": "create-link",
          "request-parameters": {
            "{item-id}": "[item-id]"
          },
          "capture": {
            "[perm-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Change read-only to read-write permissions",
      "method": "update-permission",
      "enabled": true,
      "tags": [ "service.onedrive" ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{perm-id}": "[perm-id]"
      },
      "expectations": {
        "$.roles[0]": "read"
      },

      "test-setup": [
        { "canned-request": "create-file-item" },
        {
          "method": "create-link",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.type": "edit"
          },
          "capture": {
            "[perm-id]": "$.id"
          }
        }
      ]
    },

    {
      "name": "Create a chunked upload session",
      "method": "upload-fragment-create-session",
      "enabled": true,

      "request-parameters": {
        "{item-path}": "!random-filename-vnd!",
        "$.item.name": null
      }
    },

    {
      "name": "Upload a file fragment",
      "method": "upload-fragment-piece",
      "enabled": true,

      "request-parameters": {
        "!url": "[upload-url]"
      },
      "test-setup": [
        {
          "method": "upload-fragment-create-session",
          "request-parameters": {
            "{item-path}": "!random-filename-txt!",
            "$.item.name": null
          },
          "capture": { "[upload-url]": "$.uploadUrl" }
        }
      ]
    },

    {
      "name": "Cancel a chunked upload session",
      "method": "upload-fragment-cancel",
      "enabled": true,

      "request-parameters": {
        "!url": "[upload-url]"
      },
      "test-setup": [
        {
          "method": "upload-fragment-create-session",
          "request-parameters": {
            "{item-path}": "!random-filename-txt!",
            "$.item.name": null
          },
          "capture": {
            "[upload-url]": "$.uploadUrl"
          }
        }
      ]
    },


    {
      "name": "Resume a chunked upload session",
      "method": "upload-fragment-resume",
      "enabled": true,

      "request-parameters": {
        "!url": "[upload-url]"
      },
      "test-setup": [
        {
          "method": "upload-fragment-create-session",
          "request-parameters": {
            "{item-path}": "!random-filename-txt!",
            "$.item.name": null
          },
          "capture": { "[upload-url]": "$.uploadUrl" }
        }
      ]
    },


    {
      "name": "Upload a file fragment",
      "method": "upload-fragment-final",
      "enabled": true,

      "request-parameters": {
        "!url": "[upload-url]"
      },
      "allowed-status-codes": [ 201, 200 ],
      "test-setup": [
        {
          "method": "upload-fragment-create-session",
          "request-parameters": {
            "{item-path}": "!random-filename-txt!",
            "$.item.name": null
          },
          "capture": {
            "[upload-url]": "$.uploadUrl"
          }
        },
        {
          "http-request": "PUT {upload-url}\r\nContent-Type: application/octet-stream\r\nContent-Range: bytes 0-100/128\r\n\r\nuuuuupppppllllloooooaaaaaddddduuuuupppppllllloooooaaaaaddddduuuuupppppllllloooooaaaaaddddd!!!!!!!!!",
          "request-parameters": {
            "!url": "[upload-url]"
          }
        }
      ]
    },

    {
      "name": "View MRU list",
      "method": "view-recent-files",
      "enabled": true,

      "test-setup": [
        {
          "method": "upload-via-put-id",
          "request-parameters": {
            "{item-id}": "root:/Documents/vrmtest.docx:",
            "!body": "Test file for the mru"
          },
          "capture": {
            "[download-url]": "$.['@microsoft.graph.downloadUrl']"
          }
        },
        {
          "http-request": "GET {download-url}?mru=skydrive",
          "request-parameters": {
            "{download-url}": "[download-url]"
          }
        }
      ]
    },

    {
      "name": "Upload to known folder",
      "method": "upload-via-put-id",
      "enabled": true,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "{item-id}": "[new-item-id]",
        "!body": "Test file that we will share"
      },
      "test-setup": [
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/me/drive/root:{item-path}:/content",
            "{item-path}": "/Documents/test.txt",
            "!body": "Test file that we will share"
          },
          "capture": { "[new-item-id]": "$.id" }
        }
      ]
    },
    {
      "name": "Explicit upload commit",
      "method": "explicit-upload-commit",
      "enabled": true,

      "request-parameters": {
        "{path_to_parent}": "TestFolderCommit/testfile.txt",
        "$.['@microsoft.graph.sourceUrl']": "[uploadUrl]",
        "If-Match:": "[eTag]",
        "$.name": "testfile.txt"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "{item-id}": "root:/TestFolderCommit"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put-id",
          "request-parameters": {
            "{item-id}": "root:/TestFolderCommit/testfile.txt:",
            "!body": "Test file"
          },
          "capture": {
            "[eTag]": "$.eTag"
          }
        },
        {
          "method": "upload-fragment-create-session",
          "request-parameters": {
            "!url": "/me/drive/root:/{item-path}:/createUploadSession",
            "{item-path}": "TestFolderCommit/testfile.txt",
            "$.item.name": "testfile.txt"
          },
          "capture": {
            "[uploadUrl]": "$.uploadUrl"
          }
        }
      ]
    },
    {
      "name": "Get item analytics",
      "method": "get-analytics",
      "enabled": false,
      "tags": [ "service.graph" ],

      "request-parameters": {
        "{drive-id}": "[drive-id]",
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "get-drive-default",
          "capture": {
            "[drive-id]": "$.id"
          }
        },
        {
          "canned-request": "create-file-item"
        }
      ]
    },
    {
      "name": "Get activities by interval",
      "method": "get-activities-by-interval",
      "enabled": "false"
    },
    {
      "name": "Restore drive back to date",
      "method": "restore-to-date",
      "enabled": false
    },
    {
      "name": "Create a bundle",
      "method": "create-bundle",
      "enabled": true,

      "request-parameters": {
        "$.name": "test-bundle",
        "$.children[0].id": "[item-id]",
        "$.children[1].id": "[item-id-two]"
      },
      "test-setup": [
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        },
        {
          "method": "delete-bundle",
          "request-parameters": {
            "{bundle-id}": "[bundle-id]"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "FolderForBundle/test-file.txt"
          }
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundleTwo"
          },
          "capture": {
            "[item-id-two]": "$.id"
          }
        }
      ]
    },
    {
      "name": "Create an album",
      "method": "create-album",
      "enabled": true,

      "request-parameters": {
        "$.name": "test-bundle",
        "$.children[0].id": "[item-id]"
      },
      "test-setup": [
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        },
        {
          "method": "delete-bundle",
          "request-parameters": {
            "{bundle-id}": "[bundle-id]"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "FolderForBundle/test-file.txt"
          }
        }
      ]
    },
    {
      "name": "Create a bundle",
      "method": "create-bundle-from-folder",
      "enabled": false,

      "request-parameters": {
        "$.name": "test-bundle",
        "$.children[0]": "[item-id]"
      },
      "test-setup": [
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        },
        {
          "method": "delete-bundle",
          "request-parameters": {
            "{bundle-id}": "[bundle-id]"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "FolderForBundle/test-file.txt"
          }
        }
      ]
    },
    {
      "name": "List all bundles",
      "method": "list-all-bundles",
      "enabled": true,

      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundleTwo"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundleTwo"
          },
          "capture": {
            "[item-id-two]": "$.id"
          }
        },
        {
          "method": "create-bundle",
          "request-parameters": {
            "$.name": "test-bundle",
            "$.children[0].id": "[item-id]",
            "$.children[1].id": "[item-id-two]"
          }
        }
      ]
    },
    {
      "name": "List album bundles",
      "method": "list-album-bundles",
      "enabled": true,

      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "FolderForBundle/test-file.txt"
          }
        },
        {
          "method": "create-album",
          "request-parameters": {
            "$.name": "test-bundle",
            "$.children[0].id": "[item-id]"
          }
        }
      ]
    },
    {
      "name": "Get bundle metadata",
      "method": "get-bundle-metadata",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]"
      },
      "test-setup": [
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        }
      ]
    },
    {
      "name": "Get bundle and its children",
      "method": "get-bundle-and-children",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]"
      },
      "test-setup": [
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        }
      ]
    },
    {
      "name": "Add item to bundle",
      "method": "add-to-bundle",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]",
        "$.id": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        }
      ]
    },
    {
      "name": "Remove item from a bundle",
      "method": "remove-from-bundle",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]",
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "list-all-bundles",
          "capture": {
            "[bundle-id]": "$.value[0].id"
          }
        },
        {
          "method": "add-to-bundle",
          "request-parameters": {
            "{bundle-id}": "[bundle-id]",
            "$.id": "[item-id]"
          }
        }
      ]
    },
    {
      "name": "Delete a bundle",
      "method": "delete-bundle",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundleTwo"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundleTwo"
          },
          "capture": {
            "[item-id-two]": "$.id"
          }
        },
        {
          "method": "create-bundle",
          "request-parameters": {
            "$.name": "test-bundle",
            "$.children[0].id": "[item-id]",
            "$.children[1].id": "[item-id-two]"
          },
          "capture": {
            "[bundle-id]": "$.id"
          }
        }
      ]
    },
    {
      "name": "Rename a bundle",
      "method": "rename-bundle",
      "enabled": true,

      "request-parameters": {
        "{bundle-id}": "[bundle-id]",
        "$.name": "!random-filename"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundle"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/items/{item-id}",
            "{item-id}": "root:/FolderForBundleTwo"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundle"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "create-folder",
          "request-parameters": {
            "!url": "/drive/root/children",
            "$.name": "FolderForBundleTwo"
          },
          "capture": {
            "[item-id-two]": "$.id"
          }
        },
        {
          "method": "create-bundle",
          "request-parameters": {
            "$.name": "test-bundle",
            "$.children[0].id": "[item-id]",
            "$.children[1].id": "[item-id-two]"
          },
          "capture": {
            "[bundle-id]": "$.id"
          }
        }
      ]
    },
    {
      "name": "Get tags",
      "method": "get-tags",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "add-tag-to-item",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.tags[0].name": "dog",
            "$.tags[1].name": "grass"
          }
        }
      ]
    },
    {
      "name": "Get tags by expanding",
      "method": "get-tags-with-item",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "add-tag-to-item",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.tags[0].name": "dog",
            "$.tags[1].name": "grass"
          }
        }
      ]
    },
    {
      "name": "Add tag to item",
      "method": "add-tag-to-item",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        }
      ]
    },
    {
      "name": "Add tag to collection",
      "method": "add-tag-to-collection",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        }
      ]
    },
    {
      "name": "Remove tags from item",
      "method": "remove-tags-from-item",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "$.tags[0].name": "dog",
        "$.tags[1].name": "grass"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "add-tag-to-item",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.tags[0].name": "dog",
            "$.tags[1].name": "grass"
          }
        }
      ]
    },
    {
      "name": "Remove tags from collection",
      "method": "remove-tags-from-collection",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "$.name": "dog"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "add-tag-to-item",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.tags[0].name": "dog",
            "$.tags[1].name": "grass"
          }
        }
      ]
    },
    {
      "name": "Delete tag",
      "method": "delete-tag",
      "enabled": true,
      "tags": [ "onedrive.only" ],

      "request-parameters": {
        "{item-id}": "[item-id]",
        "{tag-name}": "grass"
      },
      "test-setup": [
        {
          "method": "delete-item",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}",
            "{item-path}": "test-file.txt"
          },
          "allowed-status-codes": [ 204, 404 ]
        },
        {
          "method": "upload-via-put",
          "request-parameters": {
            "!url": "/drive/root:/{item-path}:/content",
            "{item-path}": "test-file.txt"
          },
          "capture": {
            "[item-id]": "$.id"
          }
        },
        {
          "method": "add-tag-to-item",
          "request-parameters": {
            "{item-id}": "[item-id]",
            "$.tags[0].name": "dog",
            "$.tags[1].name": "grass"
          }
        }
      ]
    },
    {
      "name": "View all photos",
      "method": "view-all-photos",
      "enabled": false
    },
    {
      "name": "View all photos filter",
      "method": "view-all-photos-filter",
      "enabled": false
    },
    {
      "name": "View all photos filter",
      "method": "view-all-photos-filter-and-expand",
      "enabled": false
    },
    {
      "name": "View all photos filter",
      "method": "view-all-photos-filter-and-expand-three",
      "enabled": false
    }
  ]
}
